\documentclass[a4paper,11pt,twoside,openany]{book}

% Page layout and formatting
\usepackage[margin=3cm]{geometry}
\usepackage{fancyhdr}
\usepackage{titlesec}
\usepackage{float}

% Define admonitions
\usepackage[most]{tcolorbox}
\tcbuselibrary{skins,breakable}
\newtcolorbox{note}[2][]{breakable,sharp corners, skin=enhancedmiddle jigsaw,parbox=false,
boxrule=0mm,leftrule=2mm,boxsep=0mm,arc=0mm,outer arc=0mm,attach title to upper,
after title={.\ }, coltitle=black,colback=gray!10,colframe=black, title={#2},
fonttitle=\bfseries,#1}

% Appendix
\usepackage[toc,page]{appendix}
\usepackage{pdfpages}

% Math packages
\usepackage{amssymb}
\usepackage{amsmath}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{siunitx}
\sisetup{range-phrase=\,--\,}  
\sisetup{range-units=single}  

% Language and encoding
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}

% Font used
\usepackage{lmodern}

% Graphics and color
\usepackage{graphicx}
\usepackage[export]{adjustbox}
\usepackage{xcolor}
\graphicspath{{images/}}

% Figures and tables
\usepackage{caption}
\usepackage{subcaption}
\usepackage{booktabs}
\usepackage{colortbl}
\usepackage{multirow}
\usepackage[font=small,labelfont=bf]{caption}
\captionsetup{justification=raggedright, singlelinecheck=false}

% Bibliography
\usepackage[backend=bibtex, style=ieee]{biblatex}
\addbibresource{references.bib}  % Replace with your .bib file
\usepackage{tocbibind}  % To include the bibliography in the TOC
\usepackage{csquotes} 
\AtEveryBibitem{
    \clearfield{urlyear}
    \clearfield{urlmonth}
}

% Hyperlinks
\usepackage[hidelinks]{hyperref}
\usepackage{url}
\usepackage[capitalise, noabbrev]{cleveref}
% \usepackage{makeidx}
% \makeindex

% Acronyms and glossaries
\usepackage[toc, acronym, symbols, automake]{glossaries-extra}
\makeglossaries
\setabbreviationstyle{long-short}
\setabbreviationstyle[acronym]{long-short}
\setabbreviationstyle[symbols]{long-short}
\input{acronyms.tex}
\input{glossary.tex}
\input{symbols.tex}
\setlength{\glsdescwidth}{0.8\hsize}

% Other utilities
\usepackage{notoccite}

\setlength{\marginparwidth}{2cm}
\usepackage[textsize=tiny]{todonotes}

% Customizations
\renewcommand{\baselinestretch}{1}  % Line spacing
\setlength{\parskip}{0.25em}        % Paragraph spacing
\setlength{\headheight}{15pt}       % Header height
\titleformat{\chapter}[display]{\normalfont\bfseries}{}{0pt}{\Huge}

% Fancyhdr settings
\fancyhead{}
\fancyfoot[C]{\thepage}
\fancyhead[LE]{\leftmark}
\fancyhead[RO]{\rightmark}
\renewcommand{\sectionmark}[1]{\markright{\thesection.\ #1}}
\renewcommand{\chaptermark}[1]{\markboth{\chaptername\ \thechapter.\ #1}{}}
\pagestyle{fancy}

\begin{document}

% Preliminary pages
\pagenumbering{roman}
\input{titlepage.tex}
\chapter*{Abstract}
\addcontentsline{toc}{chapter}{Abstract}
\input{abstract}
\tableofcontents

% Acronyms
\printglossary[style=tree, type=\acronymtype, title=List of Acronyms]
\glsaddall
\printglossary[type=symbols, style=tree, title=List of Symbols, nonumberlist]
% \addcontentsline{toc}{chapter}{List of Acronyms}

\printglossary
% \addcontentsline{toc}{chapter}{Glossary}
\glsunsetall
\glsresetall

% Main content
% \chapter{TODO}
% \input{chapters/extras}

\chapter{Introduction}
\pagenumbering{arabic}
\input{chapters/introduction}

\chapter[Photoemission Spectroscopy: Interaction, Light Sources, and Detection]{Photoemission Spectroscopy:\\Interaction, Light Sources, and Detection}\label{ch:pes}
\input{chapters/pes}

\chapter{Denoising preliminaries and BM3D}\label{ch:denoising}
\input{chapters/reconstruction}
% \input{chapters/reconstruction}

\chapter{Characterizing Photon and Photoelectron Statistics}\label{ch:pes-statistics}
\input{chapters/statistics}

\chapter{Learning from Noise}\label{ch:deep_learning}
\input{chapters/deep_learning}

\chapter{Conclusion and Outlook}
\input{chapters/conclusion}

% % Bibliography
% \bibliography{references}
\printbibliography[heading=bibintoc, title={Bibliography}]


% Additional chapters
% TODO: Add acknowledgements back
\chapter*{Acknowledgements}
\addcontentsline{toc}{chapter}{Acknowledgements}
\input{acknowledgements}

\chapter*{Contributions}
\addcontentsline{toc}{chapter}{Contributions}
\input{contributions}

% \chapter*{Declaration}
% \addcontentsline{toc}{chapter}{Declaration}
% \input{declaration}

% \printindex

\clearpage
\pagenumbering{Roman}

\begin{appendices}
  \input{appendix/math_notation.tex}
  \input{appendix/supplementary.tex}
  % \input{jupyter_notebooks/notebooks.tex}
\end{appendices}

\end{document}
