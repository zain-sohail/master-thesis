In the seminal paper by Einstein \cite{einsteinUberErzeugungUnd1905}, that laid foundations to Quantum Mechanics, Einstein postulated that light is made of discrete quanta of energy $E = h\nu$ to explain the observations by Hertz and J.J. Thompson; explaining the photoelectric effect. The effect can be described by the Equation \ref{eq:photoelectric} where $E_e$ the emitted kinetic energy, $h$ is the Planck's constant, $\nu$ the frequency of the incoming photon and  $\phi$ the material-specific work function (also known as binding energy). 

\begin{equation}\label{eq:photoelectric}
    E_e = h\nu - \phi
\end{equation}

The equation describes how incident photons on a surface eject photoelectrons, provided the photon energy $h\nu$ exceeds $\phi$.
It is then apparent that the binding energy of electrons can be found by irradiating light onto the material and measuring the $E_e$ of photoelectrons. \Gls{PES}, is exactly such a technique that leverages this principle to probe the electronic structure of materials.

\cref{eq:photoelectric} also highlights that the emitted kinetic energy $E_e$ is dependent on the photon energy but independent of the photon flux (photons per second). However, the flux of photons does affect the number of photoelectrons emitted. This effect and the probabilistic nature of the photoemission process can only be described with the quantum theory of light-matter interaction\footnote{Many of the results can be explained by semi-classical theory as well, which treats the light as a classical wave and the electrons as quantum particles.}.

The whole process of excitation, transport, and emission can be treated as a single coherent process using the formalism of quantum mechanics. This approach incorporates the electronic structure, electron-electron interactions, and the surface barrier in a unified way, and describes the photoemission intensity  $I(E, k_x, k_y)$ being proportional to probability.

The process can be described by the Fermi's Golden Rule, which gives the transition rate between two states. In the context of photoemission, the initial state is the electron in the material, and the final state is the electron in the vacuum. The intensity of photoemission can be then described by the transition rate between the two states, and the energy conservation:

\begin{equation}
    I(E, k_x, k_y) \propto |\langle \psi_f | \mathbf{A} \cdot \mathbf{p} | \psi_i \rangle|^2 \delta(E - E_f)
\end{equation}
where $\psi_i$ and $\psi_f$ represent the initial and final electron wavefunctions, $\mathbf{A} \cdot \mathbf{p}$ is the matrix element that couples the photon to the electron, and the $\delta$ function ensures energy conservation between the initial and final states.

This highlights the key element that emission process is a probabilistic event, and hence each event can be described as a \gls{rv} 
In the linear regime, an increase of photon flux results in increased photoemitted electrons (or vise versa), but not in $E_e$. However, at high photon fluxes, non-linear photoemission processes start playing a more significant role. In such a case, an electron is emitted after absorbing more than one photon, leading to a deviation from the single-photon flux relation. 

A variety of photoemission spectroscopy methods can be devised depending on which parameters are varied and what is measured. Naturally, the most basic setup would measure the energy of the emitted electron as described in equation \ref{eq:photoelectric}, while variations of the technique allow for additional parameters, such as resolving the electron momentum and spin, or dynamics.

\Gls{ARPES} measures both the kinetic energy $E_e$ and the parallel momentum components (\gls{kx}, \gls{ky}) of the emitted electrons. By varying the photon energy, \gls{ARPES} can also provide information on the surface perpendicular momentum component \gls{kz} by varying the probe energy. \Gls{XPS} focuses on the core-level electrons, providing information on the chemical composition and oxidation states of atoms in a material. By analyzing the binding energies of core electrons, \gls{XPS} can offer insights into the local electronic environment of atoms. \Gls{trPES} takes this process a step further by probing the dynamics of electronic states, allowing to understand transient, non-equibilrium phenomena. A pump-probe scheme is usually employed, where a pump laser drives the system out of equilibrium, and the core- or valence-electron states are probed by a probe laser. By applying an offset between the two pulses, the dynamics of the electronic states can be studied as a function of time.

As many of the interesting dynamics happen on the ultrafast timescale, on the order of \unit{fs} to \unit{ps}, such as charge carrier dynamics, phonon dynamics, and optically induced phase transitions, it is imperative that the light source used for \gls{trPES} has a finer temporal resolution than the timescale of the phenomena being studied. In the next section, will discuss the key light sources commonly used for \gls{trPES}, namely \gls{HHG} lasers, and \glspl{FEL}.

\Glspl{FEL} are particularly well suited for \gls{trPES} due to their high peak brightness, \unit{fs} pulse durations and energy tunability. But these high fluxes come with a caveat especially in \gls{trPES}; namely the space-charge effect. This occurs when flux of photoemitted electrons is too high, inducing a coulomb repulsion between the electrons, and leading to a distortion in their trajectories and energies. We look at the compromise between the intensity of the light source and the space-charge effect, and how the \gls{HEXTOF} instrument, equipped with the \num{8}-sector \gls{DLD}, is designed to address this challenge.

Finally, we discuss the data acquisition scheme, and the experimental datasets of \gls{GrIr}, \gls{NiW}, \gls{GdW}, and \gls{WSe2} that have been studied.

\section{Light Sources}\label{section:light-sources}
We have seen that the radiation source plays a critical role in both \gls{PES} and \gls{trPES}. Monochromatic\footnote{Truly monochromatic radiation is physically impossible, and generally a range is considered.} \gls{XUV} energy and high repetition rate sources are necessary to probe only the relevant systems, and acquire large amount of data quickly. \Gls{trPES} further requires the source to be temporally coherent, with pulse durations on the order of femtoseconds.

\subsection*{Laser}
The most ubiquitous of light sources--the laser--revolutionized experimental science as it enabled a vast range of phenomena to be precisely tested and observed, due to its high spatial and temporal coherence properties. A laser produces its light through a process known as stimulated emission, a process in which electrons, excited to higher energy states by an external energy source, emit photons as they return to lower energy states. These emitted photons, in turn, stimulate other electrons to release additional photons, leading to a cascade of coherent light. A process known as \gls{HHG} is used to generate ultrafast light of higher energies so that valence and core electrons states can be probed.

\subsection*{Free-Electron Laser}
Particle accelerators, initially used for high energy physics experiments, which produce radiation as a byproduct of particles accelerating, found their use in spectroscopy. Soon, dedicated facilities providing extremely bright and tunable source of electromagnetic radiation emerged such as Synchrotrons and \glspl{FEL}.
While Synchrotrons are excellent sources of light for a multitude of experiments, they have limitations in terms of the temporal coherence of the light produced. \Glspl{FEL} are linear particle accelerators that produce a pulsed light source with a high temporal coherence, and energies to probe core and deep valence electrons. There are two modes under which \glspl{FEL} operate: \gls{SASE} and seeded.


In \gls{SASE} mode, the amplification process is initiated by the electron shot-noise (\gls{spontaneous_emission}) when the electron beam in the accelerator passes through an undulator. Undulators are periodically arranged magnets that cause the electrons to oscillate and emit radiation. The interaction between the emitted radiation and the charge distribution leads to a phenomenon known as \gls{microbunch} \cite{ackermannOperationFreeelectronLaser2007}. These microbunches emit radiation coherently, leading to the intense, coherent radiation, characteristic of a \gls{FEL}. 

Due to the inherent stochastic nature of the process, the radiation produces intensity fluctuations and hence a lower degree of temporal coherence. Such fluctuations can be seen using a \gls{GMD} (see glossary \gls{gmd} for details) as shown in Figure \ref{fig:gmd-intensity}. The light produced by an \gls{FEL} is of high peak brightness and can be compressed to \unit{fs} pulse durations, making it an ideal source for studying ultrafast phenomena.

To improve the temporal coherence, some \glspl{FEL} such as FERMI \cite{svandrlikDevelopmentPerspectivesFERMI2017} operate in the seeded mode, where a coherent seed laser is used to initiate the amplification process. This leads to a higher degree of temporal coherence in the light produced.

\begin{figure}
    \includegraphics[width=1\linewidth]{images/flash_fel.png}
    \caption{Schematic view of \gls{FLASH} taken from \cite{faatzSimultaneousOperationTwo2016}.}
    \label{fig:flash-schematic}
\end{figure}

\gls{DESY} is a national research center in Germany that operates the \gls{FEL} \gls{FLASH} facility \cite{ackermannOperationFreeelectronLaser2007,tiedtkeSoftXrayFreeelectron2009} that produces ultrashort \gls{XUV} and soft X-ray radiation in the wavelength range of \qtyrange{4}{50}{\nm} in the fundamental, and as low as \qty{1.7}{\nm} in the third harmonic, corresponding to a total photon energy range of \qtyrange{25}{830}{\eV}. With an average pulse energy of \qtyrange{1}{500}{\micro\joule}, and pulse durations \qty{<10}{\fs}, peak powers of \qtyrange{1}{5}{\giga\watt} can be reached. This makes it an ideal source for studying ultrafast processes in materials and molecules. An example scheme of the acceleration modules, \glspl{beamline} and experimental end-stations can be seen in Figure \ref{fig:flash-schematic}, where our experiments are performed at the PG2 beamline at FLASH1 (see FLASH1 and 2 in \cref{fig:flash-schematic}).

\section{Challenges in Photoemission Spectroscopy}
With the inherent stochastic nature of the photoemission process, the only way to resolve the electronic structure with high precision is to average many events to approach the expected value, as individual measurements fluctuate around the expected value. For a constant intensity light source, the standard deviation of the measurements decreases as the square root of the number of events. This does not hold for a fluctuating source, which is prone to higher fluctuations. 

To ensure the statistical significance of time-resolved studies, the repetition rate and flux of the radiation source need to be high enough to capture non-linear effects\footnote{Nonlinear effects, such as multiphoton processes, are rare and require high flux to observe.}, to probe excited electronic states with low population densities etc. While \glspl{FEL} like \gls{FLASH} are well suited for such experiments, having a high flux can be detrimental for \gls{PES} due to the phenomenon known as the space-charge effect.

The space-charge effect occurs when intense light pulses generates a large electron density. This leads to the Coulomb repulsion between electrons, causing a distortion in the electric field, leading to a spread in the energy of the electrons\footnote{Effectively reducing the energy and momentum resolution.}. This effect is more critical in time-resolved experiments, as the pumping laser also induces an excitation. To mitigate this, the intensity of the light source must be attenuated, and the most efficient detection schemes must be used in combination with high repetition rate sources.

As can be seen on the top left of \cref{fig:hex-tof}, \gls{FLASH} provides a very high repetition rate of \qty{1}{\mega\hertz} or \qty{1}{\micro\second} gap between \glspl{pulse}. However, there are about 500 pulses in each \gls{train}, and the \gls{FEL} operates at \qty{10}{\Hz} or \qty{100}{\milli\second} between trains, having an effective rate of \num{5000} probe pulses per second. This suggests that there are no measurements over half the time. 

Efficient detection schemes are then necessary to capture all emitted electrons as not only is the repetition rate relatively low, the flux is also attenuated to be below the space-charge limit. Electron counting detectors typically have a dead-time, meaning that after a measurement, the detector is unable to detect another electron for a certain period of time. This dead-time can be longer than a pulse duration, so detection is less than an electron every pulse. More sophisticated detection schemes are then necessary to capture more emitted electrons, and reduce the acquisition time; a topic in the next section.

\section{Detection Systems: Time-of-Flight Momentum Microscope with a Multi-Sector Delay Line Detector}
The \gls{MM} allows 

The \gls{HEXTOF} instrument shown in \cref{fig:hex-tof} is designed to perform core- and valence-electron time- and momentum-resolved studies at \gls{FLASH}, addressing challenges such as low-repetition-rate sources, and the space-charge effect \cite{kutnyakhovTimeMomentumresolvedPhotoemission2020}.  The instrument combines a \gls{DLD} with a \gls{TOF} tube to detect individual electrons and measure their momentum and kinetic energy simultaneously.

One of the standout features of \gls{HEXTOF} is its multidimensional recording scheme. This approach allows for simultaneous measurement of multiple parameters that can be related to the complete momentum space \gls{kx}, \gls{ky}, \gls{kz}, energy \gls{E}, and delay time \gls{tpp}. The \gls{kx} and \gls{ky} are recorded based on the direction of the emitted electrons, while the \gls{kz} is determined by tuning the photon source. The \gls{E} is determined by the time-of-flight of the electrons, and the \gls{tpp} is the delay between the pump and probe pulses. More recently, the spin branch has been explored and spin polarization added to the list of parameters that can be measured. 

\begin{figure}
    \centering
    \includegraphics[width=1\linewidth]{images/2024-08-27-10-50-01.png}
    \caption{The \gls{FLASH} pulse structure and the \gls{HEXTOF} experimental setup. Reprinted from \cite{kutnyakhovTimeMomentumresolvedPhotoemission2020}, under the terms of the Creative Commons Attribution 4.0 International License.}
    \label{fig:hex-tof}
\end{figure}

For a detailed comparison between the hemispherical analyzer and the \gls{TOF} energy analyzer, the reader is referred to \cite{maklarQuantitativeComparisonTimeflight2020}.

\subsection*{Detector}\label{section:dld}
\subsubsection*{Microchannel Plate}
\begin{figure}[h]
    \centering
    \includegraphics[width=0.4\linewidth]{images/mcp.pdf}
    \caption{Front view of a circular \gls{MCP}, showing the hexagonal microchannel structure. \Glspl{MCP} are densely packed with millions of microchannels, each of which can amplify an electron cascade.}
    \label{fig:mcp}
\end{figure}

Individual electrons released by the photoemission process are difficult to directly detect due to their small charge.  Therefore, it is necessary to have an amplification process to allow their detection. \Gls{MCP} is one such amplifier, that is sensitive to electrons\footnote{\Glspl{MCP} are versatile as they are also sensitive to high energy photons in the \gls{XUV} regime, and also to charged particles.}
\Glspl{MCP} are made of an insulating material with a 2D array of hexagonal holes called microchannels as can be seen in \cref{fig:mcp}. With millions of such channels, each charge cloud can be localized. When an electron strikes the surface of the \gls{MCP}, it generates a cascade of secondary electrons, resulting in a final charge cloud that is orders of magnitude stronger than the initial signal. For additional gain, the \glspl{MCP} can be stacked in two layers, with V-stack (Chevron) configuration as can be seen in top of \cref{fig:dld}, where the V shape is visible when viewing MCP 1 and MCP 2 together \cite{ladislaswizaMicrochannelPlateDetectors1979,paschottaMicrochannelPlatesEncyclopedia2019}. The amplified charge cloud is then collected by a readout system, such as a phosphor screen that converts the charge cloud into light, which can be detected by a \gls{CCD} camera. This allows for the spatial distribution of the electrons to be recorded. 

For ultrafast applications such as \gls{trPES}, the phosphor--\gls{CCD} scheme is 
The readout consists of a series of meandering\footnote{This zigzag pattern increases effective length, allowing for finer temporal resolution and hence position.} wires running in orthogonal directions beneath the \gls{MCP}. The cloud of electrons can then be detected by the delay-line readout and the signal travels along the wires connected to a series of precise timing circuits. Using \glspl{TDC}, The time difference for the signal to travel from the point of impact to the readout is used to determine the position of the electron.

\subsubsection*{Delay Line Detector}
The \gls{TOF} tube built into the \gls{HEXTOF} instrument is used to measure the time electrons take to travel from the sample to the detector. The \gls{TOF} can be measured by recording the initiation of the event (when the photon pulse comes) till when they hit the \gls{MCP}. Since electrons with different energies travel at different velocities, the \gls{TOF} can be used to determine the kinetic energy of the electrons. 

The detector is divided into \num{4} quadrants, each able to detect electrons independently. This division allows the system to detect several electrons from the same or different pulses without significant dead-time. While the quandarant structure ensures higher detection, if and electron has momenta that falls in a quadrant which is already detecting an electron, the dead-time can lose the second electron. That is why the \gls{DLD} has a multi-layer structure as seen in \cref{fig:dld}, where the two layers are stacked at \qty{45}{\degree} to each other. This allows for detection of events that might fall on the same quadrant space.

\begin{figure}[h]
    \centering
    \includegraphics[width=1\linewidth]{images/dld.pdf}
    \caption{Diagram of an example \gls{DLD}, with an \gls{MCP} and a delayline structure. \textbf{\gls{MCP} Structure}: The \glspl{MCP} are arranged in a V-stack (Chevron) configuration, with microchannels at opposite tilt angles to enhance electron cascade efficiency. Each channel, shown as simplified lines within the semi-transparent blue \gls{MCP} layers, initiates an electron cascade upon impact. This cascade amplifies the signal across both \glspl{MCP}, preserving spatial information and forming a final charge cloud. \textbf{Delayline Structure}: Below the \glspl{MCP}, a detailed view of the $x$ and $y$ meandering delay lines, rotated \qty{45}{degree} relative to one another, illustrates how each delay line (labeled X and Y) captures spatial information through the timing of signals between designated endpoints ($x_1$, $x_2$, $y_1$, $y_2$).}
    \label{fig:dld}
\end{figure}

Owing to the 2-layered \gls{DLD} in our experimental setup, measuring two electrons impinging on locations nearby to one another can be detected. However, the multi-layer detection scheme comes with a caveat: the layers must be calibrated appropriately otherwise the electron counting routines can report two or more events for the same electron (due to the angle between the layers); with different momenta due to the miscalibration. With a correlation analysis on the photoelectrons generated in pulses, this effect has been observed by [Haber Thesis here]. This multiple counting also occurs within the individual layers, at the intersection of individual sectors.

This effect not only wrongly counts electrons but also distorts (blurs) the momentum distribution. \citeauthor{heberStudiesUltrafastDynamics2024} further demonstrates that by first finding the double-counted events (or more) and averaging them, the resolution of the momentum distribution can be improved as can be seen in \cref{fig:chessy-distribution} right.

\begin{figure}[h]
    \centering
    \includegraphics[width=0.7\linewidth]{images/chessy_deblurring_merged_events.png}
    \caption{Chessy sample before and after merging double-counted events, showing better resolved features. Chessy test sample is employed to determine the spatial overlap and field of view alignment in a momentum microscope using the \gls{PEEM} mode. Adapted from \cite{heberStudiesUltrafastDynamics2024}.}
    \label{fig:chessy-distribution}
\end{figure}


It has also been observed that the \gls{DLD} codes can not always accurately reconstruct the events, due to signal overlap, such as in the study by \citeauthor{knipferDeepLearningbasedSpatiotemporal2024}. They have proposed a deep learning based method to reconstruct the events accurately \cite{knipferDeepLearningbasedSpatiotemporal2024}.

\section{Experimental Datasets}\label{section:datasets}
\begin{figure}
    \centering
    \includegraphics[width=0.8\linewidth]{images/acq_time_1M.pdf}
    \caption{Total acquisition time \gls{total_time} in minutes for generating \num{e6} data points. Some outliers are present due to the photon source being off, leading to longer \gls{total_time}. The average \gls{total_time} without outliers is approximately \qty{8}{min} (see dashed line).}
    \label{fig:acq-time-1M}
\end{figure}

\begin{figure}
    \centering
    \includegraphics[width=1\linewidth]{images/datasets_3_kx_ky.pdf}
    \caption{A \gls{kx}-\gls{ky} slice of the \gls{GrIr}, \gls{NiW}, and \gls{GdW} datasets, window averaged across \gls{E} with $\gls{winsize}=\num{20}$.}
    \label{fig:all-hextof-datasets-kxky}
\end{figure}

We investigate three materials--\gls{GrIr} \cite{heberMultispectralTimeresolvedEnergy2022}, \gls{NiW} \cite{shokeenRealtimeObservationNonequilibrium2024}, and \gls{GdW} \cite{kutnyakhovMultidimensionalPhotoemissionSpectra2024}--that have been studied using \gls{HEXTOF} at \gls{FLASH}. Interpretable results from these experiments require long acquisition times (\gls{total_time}), essential for capturing the underlying physical processes. This is primarily due to three main reasons. As mentioned above, the intrinsic stochastic nature of the photoemission process requires the collection of a large number of events to approach the true value (expected value). Additionally, the low repetition rate of the \gls{FEL} means that the data  needs to be collected over a long period of time to get sufficient statistics. For example, as shown in \cref{fig:acq-time-1M}, acquiring $\gls{ncounts}=\num{e6}$ requires an acquisition time of $\gls{total_time}=\qty{8}{\min}$. Lastly, the multidimensional acquisition scheme to simultaneously resolve \gls{kx}, \gls{ky}, \gls{kz}, \gls{E}, \gls{tpp}, and spin polarization necessitates exponentially more data to adequately fill the sample space in higher dimensions.

For most of this study, we use the \gls{GrIr} dataset, as it features the longest acquisition time, and hence the highest number of counts, with $\gls{ncounts}=\num{1.86e8}$. The \gls{NiW} and \gls{GdW} datasets have comparatively lower total counts, at $\gls{ncounts}=\num{6.52e7}$ and \num{2.21e7}, respectively. However, \gls{ncounts} is not the only factor in determining data quality. Material-specific factors, sample conditions, and instrument settings can influence spectral clarity, meaning that a higher-count dataset does not necessarily guarantee more pronounced spectral features. For instance, while the \gls{NiW} dataset has a higher count rate than \gls{GdW}, its spectral features are comparatively less distinct as seen in \cref{fig:all-hextof-datasets-kxky}.

For reference, we also look at the \gls{WSe2} dataset \cite{maklarTimeresolvedARPESRAW2022}, measured with a pulsed laser-based \gls{XUV} source and a \gls{TOF} \gls{MM} analyzer. This dataset has a much larger number of counts, with $\gls{ncounts}=\num{e9}$, recorded in $\gls{total_time}=\qty{27}{s}$, compared to acquiring $\gls{ncounts}=\num{e6}$ in $\gls{total_time}=\qty{8}{\min}$ for the \gls{GrIr} dataset. The \gls{WSe2} dataset is used to compare the performance of denoising algorithms on a high-count dataset.

\begin{figure}[h]
    \centering
    \includegraphics[width=1\linewidth]{images/41597_2020_769_Fig2_HTML.png}
    \caption{A typical workflow for a \gls{trPES} experiment. Reprinted from \cite{xianOpensourceEndtoendWorkflow2020}, under the terms of the Creative Commons Attribution 4.0 International License.}
    \label{fig:mpes_workflow}
\end{figure}

For a \gls{trPES}, a common workflow is shown in \cref{fig:mpes_workflow}, where the measurement axes is first mapped to the  physical axes and the single-event data is binned into a multidimensional volume\footnote{We make use of the \gls{SED} library \href{https://github.com/OpenCOMPES/sed}{https://github.com/OpenCOMPES/sed}.}. For an in depth description of how data is extracted and transformed, please refer to Appendix~\ref{sec:elt}.

\begin{figure}
    \centering
    \includegraphics[width=0.5\linewidth]{images/calibrated_momentum.pdf}
    \caption{2D slice (window-averaged over the energy dimension) of the \gls{GrIr} dataset in the \gls{ky}--\gls{kx} plane. The data has been calibrated to map the pixel values to the physical momentum axes.}
    \label{fig:grir-2d-slice-calibrated}
\end{figure}

\begin{figure}
    \centering
    \begin{subfigure}[t]{0.49\linewidth}
        \centering
        \includegraphics[width=1\linewidth]{images/3d_gr_ir_8M.png}
        \caption{$\gls{ncounts}=\num{8e6}$ corresponding to $\gls{total_time}=\qty{8}{min}$. The fine features of the data are not visible due to the low count rate.}
        \label{fig:3d-gr-ir-8M}
    \end{subfigure}
    \hfill
    \begin{subfigure}[t]{0.49\linewidth}
        \centering
        \includegraphics[width=1\linewidth]{images/3d_gr_ir_masked.png}
        \caption{$\gls{ncounts}=\num{1.86e8}$ corresponding to $\gls{total_time}=\qty{30}{hour}$. 2D images can be formed by slicing (or window averaging) along any of the axes, as depicted by the three lines.}
        \label{fig:3d-gr-ir-186M}
    \end{subfigure}
    \caption{3D images from the \gls{GrIr} dataset, with $\gls{ncounts}=\num{8e6}$ and \num{1.86e8}. The image is constructed by binning over the three physical axes $k_x$, $k_y$, $E$.}
    \label{fig:3d-gr-ir}
\end{figure}


If we just want to look at the static results, a 3D image such as \cref{fig:3d-gr-ir} can be formed by binning across the three physical axes--\gls{kx}, \gls{ky} and \gls{E}--from different datasets such as the \gls{GrIr} dataset, which contains \num{1.86e8} electron counts in the entire dataset. The average count decreases when binning across additional dimensions, such as the pump-probe time \gls{tpp} or spin polarization. After focusing on a \gls{ROI} (\gls{EF} and near), and 3D binning with an image resolution of \qty{460}{px} in each direction, the total counts are \num{1.15e8}, with an average count of $\approx$\num{1.13} per voxel.  Slicing along the \gls{E} direction, we can form 2D images such as the one shown in \cref{fig:grir-2d-slice-calibrated}.

With the \gls{DLD} providing a stream of single-event data, we are uniquely positioned to observe noisy realizations by taking subsets of varying electron counts \gls{ncounts} from the full dataset. These subsets can then be binned to form independent 3D images, used later for evaluating and training denoising algorithms.


 For instance, the complete dataset, \num{186} subsets, sampled at $\gls{ncounts}=\num{e6}$ intervals, can be extracted. In theory, the data generation is an independent stochastic process, allowing for a large variety of randomly sampled subsets. However, in our case, the \gls{FEL} light source introduces a degree of dependence as it is not stable over extended periods, beyond its intrinsic fluctuations.


\begin{table}[h]
    \centering
    \resizebox{0.6\textwidth}{!}
        {%
        \begin{tabular}{lrrr}
            \toprule
            & \gls{ncounts} & Average Counts & $T$ [h] \\
            &  & Per Voxel & \\
            \midrule
            $n$ & \num{1e6} & \num{5.98e-3} & $\num{0.13}$ \\
            $2n$ & \num{2e6} & \num{1.22e-2} & $\num{0.28}$ \\
            $4n$ & \num{4e6} & \num{2.44e-2} & $\num{0.57}$ \\
            $8n$ & \num{8e6} & \num{4.89e-2} & $\num{1.23}$ \\
            $16n$ & \num{1.6e7} & \num{9.77e-2} & $\num{2.62}$ \\
            $32n$ & \num{3.2e7} & \num{2.00e-1} & $\num{5.32}$ \\
            $48n$ & \num{4.8e7} & \num{2.90e-1} & $\num{8.14}$ \\
            $96n$ & \num{9.6e7} & \num{5.84e-1} & $\num{16.07}$ \\
            $186n$ & \num{1.86e8} & \num{11.3e-1} & $\num{30.78}$ \\
            \bottomrule
        \end{tabular}
        }
    \caption{Table shows the noisy realizations generated by varying number of counts \gls{ncounts}, with the acquisition time being proportional to \gls{ncounts}. $\gls{ncounts}=\num{1.86e8}$ serves as the reference dataset.}
    \label{noisy-dataset-table}
\end{table}

Noisy realizations can then be formed based on a number of total counts. The total counts and average counts per voxel for each noisy realization are shown in \cref{noisy-dataset-table}. These realizations can help evaluate the performance of denoising algorithms as a function of \gls{total_time}. Lower count realizations ($\gls{ncounts}<\num{e7}$), corresponding to shorter \gls{total_time}, are of most interest to denoise. Successful denoising of such data could significantly improve experimental efficiency, allowing the investigators to steer the experiment in the right direction, crucial in time-limited \glspl{beamtime}. Hence, the realizations are sampled at $\gls{ncounts}=$ \numlist{1e6;2e6;4e6;8e6;1.6e7;3.2e7;4.8e7;9.6e7}.


% \subsection{Calibration}
% We present an example calibration workflow to calibrate--mapping of pixel values to the momentum axes of \gls{GrIr} dataset. Graphene is a 2D material with carbon atoms arranged in a hexagonal honeycomb structure. The Brillouin zone exhibits high-symmetry points in the reciprocal lattice (momentum space) such as the $K$-point and $K'$-point, located at the corners of the hexagonal zone, and $\Gamma$-point, located at the center \cite{castronetoElectronicPropertiesGraphene2009}. The calibration process is to map the detector pixel axes to the physical momentum axes.

% In graphene's reciprocal lattice, the momentum space coordinates of the $K$-point can be derived from the lattice vectors. The reciprocal lattice vector components in the hexagonal Brillouin zone are given by:
% \begin{equation*}
%     k_x = \frac{2\pi}{3a}
% \end{equation*}
% \begin{equation*}
%     k_y = \frac{2\pi}{3\sqrt{3}a}
% \end{equation*}
% with $a\approx$\qty{1.42}{\angstrom}, the carbon-carbon bond length. The distance from the $\Gamma$-point to $K$-point in is just:

% \begin{equation*}
%     d_{\Gamma K} = \sqrt{k_x^2 + k_y^2}
% \end{equation*}

% Substituting $a$, we obtain $d_{\Gamma K} = \qty{1.71}{\angstrom^{-1}}$. The pixel distance between the $\Gamma$-point and $K$-point in the detector image is computed to be $190$px (see \cref{fig:original-pixel-gamma-k} left). $d_{\Gamma K}/190$ then gives the scaling factor to calibrate the \gls{DLD} X and Y coordinates to \gls{kx} and \gls{ky}, respectively. The calibrated momentum axes are shown in \cref{fig:calibrated-momentum} right.


% \begin{figure}[ht]
%     \centering
%     % First subfigure (Original Image with Γ and K Points)
%     \begin{subfigure}[t]{0.49\linewidth}
%         \centering
%         \includegraphics[width=\linewidth]{images/original_image_gamma_k.pdf}
%         \caption{Uncalibrated image with \gls{DLD} X and Y coordinates, marked with the $\Gamma$ and $K$ points, and the distance between them--$190$px.}
%         \label{fig:original-pixel-gamma-k}
%     \end{subfigure}
%     \hfill
%     % Second subfigure (Momentum-Calibrated Image)
%     \begin{subfigure}[t]{0.49\linewidth}
%         \centering
%         \includegraphics[width=\linewidth]{images/calibrated_momentum.pdf}
%         \caption{Calibrated momentum axes.}
%         \label{fig:calibrated-momentum}
%     \end{subfigure}
%     \caption{The detector axis and calibrated momentum axis. The left image shows the original image with the $\Gamma$ and $K$ points marked. The right image shows the calibrated momentum axes.}
% \end{figure}